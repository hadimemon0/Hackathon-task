<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ChatGPT Dashboard — Responsive</title>
      <link rel="icon" type="image/png" href="ChatGPT Image Nov 1, 2025, 04_19_28 PM.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    :root{
      --sidebar-width: 260px;
      --sidebar-collapsed: 70px;
    }
    html,body{height:100%;}
    body {
      background-color: #f8f9fa;
    }

    /* Layout */
    .app-wrapper{
      display:flex;
      min-height:100vh;
      overflow:hidden;
    }

    .sidebar{
      width:var(--sidebar-width);
      background:#212529;
      color:#fff;
      display:flex;
      flex-direction:column;
      transition:width .25s ease;
    }
    .sidebar.collapsed{
      width:var(--sidebar-collapsed);
    }
    .sidebar .logo{
      font-weight:700;
      font-size:1.125rem;
      padding:1rem;
      border-bottom:1px solid rgba(255,255,255,0.06);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .chat-list{flex:1;overflow:auto;}
    .chat-item{padding:.75rem 1rem;cursor:pointer;color:#ddd;}
    .chat-item:hover,.chat-item.active{background:#343a40;color:#fff;}
    .sidebar-footer{padding:1rem;border-top:1px solid rgba(255,255,255,0.06);}

    .main-area{flex:1;display:flex;flex-direction:column;}
    .chat-header{padding:1rem;border-bottom:1px solid #dee2e6;display:flex;align-items:center;justify-content:space-between;gap:.5rem;}
    .chat-messages{flex:1;overflow:auto;padding:1rem;background:#f1f3f5;}
    .message{max-width:75%;padding:.75rem 1rem;border-radius:1rem;margin-bottom:1rem;word-wrap:break-word;}
    .message.user{background:#0d6efd;color:#fff;margin-left:auto;}
    .message.bot{background:#e9ecef;color:#212529;margin-right:auto;}
    .chat-input{border-top:1px solid #dee2e6;padding:1rem;background:#fff;}
    textarea.form-control{height:auto;min-height:56px;max-height:200px;resize:none;border-radius:.75rem;padding:.75rem;}

    /* Mobile tweaks */
    @media (max-width: 992px){
      .sidebar{position:fixed;left:0;top:0;bottom:0;z-index:1045;transform:translateX(0);}
      .sidebar.hidden{transform:translateX(-110%);} /* hide off-canvas */
      .main-area{margin-left:0;}
      .overlay{display:block;position:fixed;inset:0;background:rgba(0,0,0,.35);z-index:1040;opacity:0;pointer-events:none;transition:opacity .15s ease;}
      .overlay.visible{opacity:1;pointer-events:auto;}
    }

    /* Desktop collapsed state */
    @media (min-width: 993px){
      .main-area{margin-left:0;}
      .sidebar .logo.small{display:none;}
      .sidebar.collapsed .logo{padding-left:.5rem;}
      .sidebar.collapsed .chat-item{padding:.5rem;text-align:center;font-size:0.85rem;}
      .sidebar.collapsed .chat-list{padding-top:.5rem}
      .sidebar.collapsed .logo{white-space:nowrap;overflow:visible;text-overflow:clip}
    }

    /* Utility */
    .hidden-xs{display:none;}@media(min-width:576px){.hidden-xs{display:inline-block}}
  </style>
  <button class="btn btn-sm btn-outline-danger" id="clearChat">Clear</button>
</head>
<body>
  <div class="app-wrapper">
    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
      <div>
        <div class="logo">H-Pitch</div>
        <div class="chat-list" id="chatList">
          <div class="chat-item active">Welcome</div>
          <div class="chat-item">Project: Landing Page</div>
          <div class="chat-item">Ideas</div>
        </div>
      </div>
      <div class="sidebar-footer">
        <button class="btn btn-outline-light w-100 btn-sm add" id="newChatBtn">+ New Chat</button>
        <button class="btn btn-light w-100 btn-sm mt-2 d-none d-md-block" id="collapseBtn">Collapse</button>
      </div>
    </nav>

    <!-- overlay for mobile -->
    <div class="overlay" id="overlay" style="display:none"></div>

    <!-- Main chat area -->
    <div class="main-area">
      <div class="chat-header">
        <div class="d-flex align-items-center gap-2">
          <button class="btn btn-outline-secondary btn-sm d-lg-none" id="mobileMenuBtn" aria-label="Open menu">☰</button>
          <h6 class="mb-0" id="chatTitle">Welcome — Getting Started</h6>
        </div>
        <div class="d-flex gap-2 align-items-center">
          <div class="btn-group" role="group" aria-label="Theme selectors">
            <button class="btn btn-sm btn-outline-secondary" id="toggleTheme">Light</button>
            <button class="btn btn-sm btn-outline-danger" id="deleteChat">Delete</button>
          </div>
        </div>
      </div>

      <div class="chat-messages" id="chatMessages" aria-live="polite">
        <div class="message user">Show me your dashboard design.</div>
        <div class="message bot">Here’s a clean layout built with Bootstrap only.</div>
      </div>

      <div class="chat-input">
        <div class="input-group">
          <textarea class="form-control" id="inputMessage" placeholder="Type your message..." rows="1"></textarea>
          <button class="btn btn-primary" id="sendBtn">Send</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Elements
    const sidebar = document.getElementById('sidebar');
    const collapseBtn = document.getElementById('collapseBtn');
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const overlay = document.getElementById('overlay');
    const sendBtn = document.getElementById('sendBtn');
    const inputMessage = document.getElementById('inputMessage');
    const chatMessages = document.getElementById('chatMessages');
    const newChatBtn = document.getElementById('newChatBtn');

    // Responsive sidebar: collapse on desktop, off-canvas on mobile
    collapseBtn?.addEventListener('click', () => {
      sidebar.classList.toggle('collapsed');
      collapseBtn.textContent = sidebar.classList.contains('collapsed') ? 'Expand' : 'Collapse';
    });

    mobileMenuBtn?.addEventListener('click', () => {
      sidebar.classList.toggle('hidden');
      overlay.classList.toggle('visible');
      overlay.style.display = sidebar.classList.contains('hidden') ? 'none' : 'block';
      // For small screens we show/hide
      if(window.innerWidth < 992){
        if(!sidebar.classList.contains('hidden')){
          overlay.classList.add('visible');
        } else {
          overlay.classList.remove('visible');
        }
      }
    });

    let chats = JSON.parse(localStorage.getItem("chats")) || [];
let currentChatIndex = 0;

function renderChat() {
  chatMessages.innerHTML = "";
  if (!chats[currentChatIndex]) return;

  chats[currentChatIndex].forEach(msg => {
    appendMessage(msg.text, msg.cls);
  });
}

document.getElementById("clearChat").addEventListener("click", () => {
  chats[currentChatIndex] = [];
  renderChat();
  localStorage.setItem("chats", JSON.stringify(chats));
});



    overlay.addEventListener('click', () => {
      sidebar.classList.add('hidden');
      overlay.classList.remove('visible');
    });

    // Autosize textarea: simple implementation
    function autoSizeTextarea(el){
      el.style.height = 'auto';
      el.style.height = (el.scrollHeight) + 'px';
    }
    inputMessage.addEventListener('input', (e)=>autoSizeTextarea(e.target));

    // Append message helper
    function appendMessage(text, cls='user'){
      const div = document.createElement('div');
      div.className = 'message ' + cls;
      div.textContent = text;
      chatMessages.appendChild(div);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Simulated AI response / placeholder for real API
   async function fetchAIResponse(message){
  const response = await fetch("http://localhost:3000/api/respond", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ message })
  });

  return await response.json();
}


    sendBtn.addEventListener('click', async ()=>{
  const txt = inputMessage.value.trim();
  if(!txt) return;

  if (!chats[currentChatIndex]) chats[currentChatIndex] = [];

  chats[currentChatIndex].push({ text: txt, cls: "message user" });
  appendMessage(txt, 'user');

  inputMessage.value = '';
  autoSizeTextarea(inputMessage);

  const typing = document.createElement('div');
  typing.className = 'message bot';
  typing.textContent = 'Typing…';
  chatMessages.appendChild(typing);

  try {
    const res = await fetchAIResponse(txt);
    typing.remove();
    chats[currentChatIndex].push({ text: res.reply, cls: "message bot" });
    appendMessage(res.reply, 'bot');

    localStorage.setItem("chats", JSON.stringify(chats));

  } catch(err){
    typing.remove();
    appendMessage('Error: could not get response', 'bot');
  }
});



    inputMessage.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' && !e.shiftKey){
        e.preventDefault();
        sendBtn.click();
      }
    });

   newChatBtn.addEventListener('click', ()=>{
  chats.push([]);
  currentChatIndex = chats.length - 1;
  renderChat();
  document.getElementById('chatTitle').textContent = 'New chat';

  localStorage.setItem("chats", JSON.stringify(chats));
});

document.querySelectorAll('.chat-item').forEach((item, index) => {
  item.addEventListener('click', () => {
    currentChatIndex = index;
    renderChat();
  });
});


    function handleResize(){
      if(window.innerWidth < 992){
        sidebar.classList.add('hidden');
        overlay.style.display = 'none';
      }else{
        sidebar.classList.remove('hidden');
        overlay.style.display = 'none';
      }
    }
    window.addEventListener('resize', handleResize);
    handleResize();

    window.addEventListener('keydown', (e)=>{
      if(e.ctrlKey && e.key.toLowerCase() === 'b'){
        e.preventDefault();
        sidebar.classList.toggle('collapsed');
      }
    });

    function saveState(){
      const state = {messages: Array.from(chatMessages.children).map(n=>({text:n.textContent,cls:n.className}))};
      localStorage.setItem('chat_state', JSON.stringify(state));
    }
    function restoreState(){
      try{
        const state = JSON.parse(localStorage.getItem('chat_state'));
        if(state && state.messages){
          chatMessages.innerHTML = '';
          state.messages.forEach(m=>{
            const d = document.createElement('div');
            d.className = m.cls;
            d.textContent = m.text;
            chatMessages.appendChild(d);
          });
        }
      }catch(e){console.warn(e)}
    }
    window.addEventListener('beforeunload', saveState);
function restoreState(){
  chats = JSON.parse(localStorage.getItem("chats")) || [[]];
  currentChatIndex = 0;
  renderChat();
}
      </script>
</body>
</html>
